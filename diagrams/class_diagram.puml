@startuml
' Diagrama de Clases

skinparam classAttributeIconSize 0

package models {
  class Customer {
    -name: String
    -contactInfo: String
    
    +Customer(name: String, contactInfo: String)
    +getName(): String
    +setName(name:String): void
    +getContactInfo(): String
    +setContactInfo(contactInfo: String): void
    +toString(): String
  }

  class Table {
    -tableNumber: int
    -capacity: int
    -isAvailable: boolean

    +Table(tableNumber: int, capacity: int)
    +getTableNumber(): int
    +setTableNumber(tableNumber: int): void
    +getCapacity(): int
    +setCapacity(capacity: int): void
    +isAvailable(): boolean
    +setAvailable(available: boolean): void
    +toString(): String
  }

  class MenuItem {
    -name: String
    -description: String
    -price: BigDecimal
    -category: String

    +MenuItem(name: String, description: String, price: BigDecimal, category: String)
    +getName(): String
    +setName(name: String): void
    +getDescription(): String
    +setDescription(description: String): void
    +getPrice(): BigDecimal
    +setPrice(price: BigDecimal): void
    +getCategory(): String
    +setCategory(category: String): void
    +toString(): String
  }

  class Reservation {
    -customer: Customer
    -table: Table
    -reservationTime: LocalDateTime
    -numberOfGuests: int
    -status: ReservationStatus

    +Reservation(customer: Customer, table: Table, reservationTime: LocalDateTime, numberOfGuests: int)
    +getCustomer(): Customer
    +setCustomer(customer: Customer): void
    +getTable(): Table
    +setTable(table: Table): void
    +getReservationTime(): LocalDateTime
    +setReservationTime(reservationTime: LocalDateTime): void
    +getNumberOfGuests(): int
    +setNumberOfGuests(numberOfGuests: int): void
    +getStatus(): ReservationStatus
    +setStatus(status: ReservationStatus): void
    +toString(): String
  }

  enum ReservationStatus {
    CONFIRMED
    CANCELED
    PENDING
  }

  class Order {
    -customer: Customer
    -table: Table
    -status: OrderStatus
    -items: List<MenuItem>

    +Order(customer: Customer, table: Table, status: OrderStatus, items: List<MenuItem>)
    +getCustomer(): Customer
    +setCustomer(customer: Customer): void
    +getTable(): Table
    +setTable(table: Table): void
    +getStatus(): OrderStatus
    +setStatus(status: OrderStatus): void
    +addItem(item: MenuItem): void
    +getTotal(): BigDecimal
    +toString(): String
  }

  enum OrderStatus {
    PENDING
    IN_PROGRESS
    COMPLETED
    SERVED
    CANCELED
  }

  class Invoice {
    -order: Order
    -totalAmount: BigDecimal
    -paymentMethod: PaymentMethod
    -issueDate: LocalDateTime

    +Invoice(order: Order, paymentMethod: PaymentMethod)
    +getOrder(): Order
    +setOrder(order: Order): void
    +getTotalAmount(): BigDecimal
    +setTotalAmount(totalAmount: BigDecimal): void
    +getPaymentMethod(): PaymentMethod
    +setPaymentMethod(paymentMethod: PaymentMethod): void
    +getIssueDate(): LocalDateTime
    +setIssueDate(issueDate: LocalDateTime): void
    +toString(): String
  }

  enum PaymentMethod {
    CASH
    CREDIT_CARD
    DEBIT_CARD
    BANK_TRANSFER
  }
}

' --- Relaciones ---

Reservation o-- Customer : "tiene un"
Reservation o-- Table : "tiene un"
Order o-- Customer : "tiene un"
Order o-- Table : "tiene un"
Order o-- MenuItem : "tiene varios"
Invoice o-- Order : "tiene un"

' --- Capa de Servicios ---

package services {
  class MenuService {
    -menuItems: List<MenuItem>
    -menuItemDao: DataAccessObject<MenuItem>

    +initializeDefaultMenu(): void
    +addMenuItem(item: MenuItem): void
    +getMenuItems(): List<MenuItem>
    +getMenuItemByName(name: String): Optional<MenuItem>
    +removeMenuItem(name: String): boolean
    +saveMenuItems(): void
  }

  class TableService {
    -tables: List<Table>
    -tableDao: DataAccessObject<Table>

    +TableService(tableDao: DataAccessObject<Table>)
    +initializeDefaultTables(): void
    +getAllTables(): List<Table>
    +getAvailableTables(): List<Table>
    +getTableByNumber(tableNumber: int): Table
    +updateTableAvailability(tableNumber: int, isAvailable: boolean): void
    +saveTables(): void
  }

  class ReservationService {
    -reservations: List<Reservation>
    -reservationDao: DataAccessObject<Reservation>
    -tableService: TableService

    +ReservationService(reservationDao: DataAccessObject<Reservation>, tableService: TableService)
    +createReservation(...): Reservation
    +cancelReservation(reservation: Reservation): void
    +getAllReservations(): List<Reservation>
    +saveReservations(): void
  }

  class OrderService {
    -orders: List<Order>
    -orderDao: DataAccessObject<Order>
    -menuService: MenuService
    -tableService: TableService

    +OrderService(orderDao: DataAccessObject<Order>, menuService: MenuService, tableService: TableService)
    +createOrder(...): Order
    +addItemToOrder(order: Order, itemName: String): void
    +updateOrderStatus(order: Order, newStatus: OrderStatus): void
    +getAllOrders(): List<Order>
    +saveOrders(): void
  }

  class InvoiceService {
    -invoices: List<Invoice>
    -invoiceDao: DataAccessObject<Invoice>
    -tableService: TableService

    +InvoiceService(invoiceDao: DataAccessObject<Invoice>, tableService: TableService)
    +generateInvoice(order: Order, pm: PaymentMethod): Invoice
    +getAllInvoices(): List<Invoice>
    +saveInvoices(): void
  }
}

' --- Capa de Persistencia ---

package persistence {
  interface DataAccessObject<T> {
    +saveAll(items: List<T>): void
    +loadAll(): List<T>
  }

  class JsonDao<T> {
    -filePath: String
    -gson: Gson

    +JsonDao(filePath: String)
    +saveAll(items: List<T>): void
    +loadAll(): List<T>
  }

  JsonDao ..|> DataAccessObject: "implementa"
}

' --- Relaciones entre capas ---

MenuService o-- DataAccessObject: "tiene un"
TableService o-- DataAccessObject: "tiene un"
ReservationService o-- DataAccessObject: "tiene un"
OrderService o-- DataAccessObject: "tiene un"
InvoiceService o-- DataAccessObject: "tiene un"

ReservationService o-- TableService: "tiene un"
OrderService o-- MenuService: "tiene un"
OrderService o-- TableService: "tiene un"
InvoiceService o-- TableService: "tiene un"

@enduml
